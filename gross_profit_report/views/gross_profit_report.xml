<?xml version="1.0" encoding="utf-8"?>

<odoo>
	<data>

		<record model="ir.ui.view" id="tree_gross_profit_sql_view_report">
			<field name="name">Gross Profit Tree</field>
			<field name="model">gross_profit_report.gross_profit_sql_report</field>
			<field name="arch" type="xml">
				<tree string="Gross Profit" create="0" delete = '0' decoration-muted = 'gp_amount&lt;0' decoration-info = 'gp_amount&gt;0' default_order = 'product_template_id,pricelist_id'> 
					<field name='pricelist_id'/>
					<field name='product_template_id'/>
					<field name='product_category'/>
					<field name='company_id'/>
					<field name='currency_id'/>
					<field name='uom' optional = 'hide'/>
					<field name='uom_ratio' optional = 'hide'/>
					<field name='sale_price' widget = 'monetary'/>
					<field name='purchased_uom' optional = 'hide'/>
					<field name='purchased_uom_ratio' optional = 'hide'/>
					<field name='purchased_price' widget = 'monetary'/>
					<field name='gp_amount' widget = 'monetary'/>
					<field name='gp_perc'/>
					<!-- <field name='user_id'/> -->
				</tree>
			</field>
		</record>

		<record id="search_gross_profit_sql_view_report" model="ir.ui.view">
            <field name="name">Gross Profit Search</field>
            <field name="model">gross_profit_report.gross_profit_sql_report</field>
            <field name="arch" type="xml">
                <search string="Gross Profit">
                    <field name="product_template_id"/>
                    <field name="product_category"/>
                    <field name="pricelist_id"/>

                    <filter string='Profited' name="filter_only_profitted" domain = "[('gp_amount', '>', 0)]"/>

                    <separator/>
                    <group expand='0' string='Group by ...'>
                        <filter string='Product' name="group_by_product_template_id" context="{'group_by': 'product_template_id'}"/>
                        <filter string='Product Category' name="group_by_product_category" context="{'group_by': 'product_category'}"/>
                        <filter string='Pricelist' name="group_by_pricelist_id" context="{'group_by': 'pricelist_id'}"/>
                        <filter string='Company' name="group_by_company_id" context="{'group_by': 'company_id'}"/>
                    </group>
                </search>
            </field>
        </record>

		<record id="action_gross_profit_sql_view_report" model="ir.actions.act_window">
			<field name="name">Gross Profit</field> 
			<field name="type">ir.actions.act_window</field> 
			<field name="res_model">gross_profit_report.gross_profit_sql_report</field>
			<field name="view_mode">tree,form</field> 
			<field name="context">{'search_default_group_by_product_template_id': 1}</field>

		</record>


		 <menuitem 
		 	name="Gross Profit Report" 
		 	action="action_gross_profit_sql_view_report"
		 	id="menu_gross_profit_sql_view_report" 
            parent="sale.menu_sale_report" 
            sequence="10000"/>

	</data>
</odoo>